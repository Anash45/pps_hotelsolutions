import{r as n,b as F,j as e,c as v,I as u,T as p,a as r,D as P,S as A,e as D,P as E,h as B,A as j,i as L,k as G,H as I}from"./app-QDN181S1.js";import{G as M}from"./GuestBox-BCn3Kzx8.js";import{H as S}from"./HotelKeyFinder-C_dofTbn.js";import{H as C}from"./HotelLanding-LJgobElW.js";import{F as K}from"./FlashMessage-By5-lGvB.js";import{G as V}from"./GuestKeyLayout-B5OZtcDO.js";import{m as R}from"./mapHotelToBrandingFormData-4vqDWvsW.js";function Y(){const[i,h]=n.useState(!1),{t:s}=F("Components.userSelfEdit");if(i)return e.jsx(T,{});const{codeDetails:g}=v().props,[t,x]=n.useState({}),[w,b]=n.useState(""),[m,k]=n.useState(!0),[f,c]=n.useState(!1),[a,_]=n.useState({salutation:"",title:"",first_name:"",last_name:"",room_number:"",phone_number:"",email:"",stay_from:"",stay_till:"",gdpr_consent:m,code_id:g?.code??null}),l=d=>{const{name:o,value:N}=d.target;_(H=>({...H,[o]:N}))},y=async d=>{d.preventDefault(),x({}),b(""),c(!0);try{const o=await B.post(route("keyassignment.userStore"),a);o.data.success?(c(!1),b(o.data.message),setTimeout(()=>window.location.reload(),2e3)):(c(!1),x({general:[o.data.message]}))}catch(o){if(c(!1),o.response?.status===422){const N=o.response.data;x(N.errors||{general:[N.message]})}else x({general:[s("genericError")]})}};return e.jsxs("form",{onSubmit:y,className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-lg text-[#201A20] font-semibold",children:s("title")}),e.jsx("p",{className:"text-xs font-medium text-[#475569]",children:s("subtitle")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"stay_from",value:s("stayFrom"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"stay_from",name:"stay_from",value:a.stay_from,onChange:l,type:"date",className:"date-inp block w-full",placeholder:"dd.mm.yyyy"}),e.jsx(r,{message:t.stay_from})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"stay_till",value:s("stayTill"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"stay_till",name:"stay_till",value:a.stay_till,onChange:l,type:"date",className:"date-inp block w-full",placeholder:"dd.mm.yyyy"}),e.jsx(r,{message:t.stay_till})]})]}),e.jsx(P,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"salutation",value:s("salutation"),className:"text-[#475569] text-xs font-medium"}),e.jsx(A,{id:"salutation",name:"salutation",value:a.salutation,onChange:l,className:"w-full block",options:[{value:"Mr",label:s("mr")},{value:"Mrs",label:s("mrs")},{value:"Ms",label:s("ms")}]}),e.jsx(r,{message:t.salutation})]}),m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"title",value:s("titleLabel"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"title",name:"title",value:a.title,onChange:l,type:"text",className:"block w-full",placeholder:s("titlePlaceholder")}),e.jsx(r,{message:t.title})]}),m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"first_name",value:s("firstName"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"first_name",name:"first_name",value:a.first_name,onChange:l,type:"text",className:"block w-full",placeholder:s("firstNamePlaceholder")}),e.jsx(r,{message:t.first_name})]}),m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"last_name",value:s("lastName"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"last_name",name:"last_name",value:a.last_name,onChange:l,type:"text",className:"block w-full",placeholder:s("lastNamePlaceholder")}),e.jsx(r,{message:t.last_name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"room_number",value:s("roomNumber"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"room_number",name:"room_number",value:a.room_number,onChange:l,type:"text",className:"block w-full",placeholder:s("roomNumberPlaceholder")}),e.jsx(r,{message:t.room_number})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"phone_number",value:s("phoneNumber"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"phone_number",name:"phone_number",value:a.phone_number,onChange:l,type:"tel",className:"block w-full",placeholder:s("phoneNumberPlaceholder")}),e.jsx(r,{message:t.phone_number})]}),m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"email",value:s("email"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"email",name:"email",value:a.email,onChange:l,type:"email",className:"block w-full",placeholder:s("emailPlaceholder")}),e.jsx(r,{message:t.email})]})]})]}),e.jsx(K,{message:w}),e.jsxs("div",{className:"flex items-center gap-2 justify-end flex-wrap",children:[f&&e.jsx("p",{className:"text-sm",children:s("loading")}),Object.keys(t).length>0&&e.jsx(r,{message:t?.general??s("formError")}),e.jsx(D,{onClick:()=>h(!0),children:s("cancel")}),e.jsx(E,{disabled:f,type:"submit",children:s("save")})]})]})}function T(){const{codeDetails:i,flash:h}=v().props,[s,g]=n.useState(!1);F("Components.AskDetails");const t=()=>{L.get(route("key.makeActive",{code:i.code}))},x=()=>{g(!0)};return s?e.jsx(Y,{}):e.jsxs("div",{className:"space-y-4 text-center sm:px-7 py-4 text-base",children:[e.jsx("div",{className:"h-[120px] w-[120px] flex items-center justify-center mx-auto rounded-full border-light border",children:e.jsx("img",{src:"/images/key_icon.svg",alt:"Key",className:"h-16 w-16"})}),e.jsx("p",{children:e.jsx(j,{text:"This key can serve as a key finder after your stay."})}),e.jsx("p",{children:e.jsx(j,{text:'To do so, you must enter your mobile number along with other details in the next dialog so that a finder can <span class="font-bold">contact you</span>.'})}),e.jsx("p",{children:e.jsx(j,{text:"Would you like to use the key finder function?"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(E,{onClick:x,children:e.jsx(j,{text:"Yes"})}),e.jsx(D,{onClick:t,children:e.jsx(j,{text:"No"})})]})]})}function z(){const{selectedHotel:i=null,codeDetails:h}=v().props,{brandingFormData:s,setBrandingFormData:g,loadingButton:t}=n.useContext(G),[x,w]=n.useState(!1),{url:b}=v();n.useEffect(()=>{i&&g(R(i,{user_view:!0}))},[i,b]);const m=h?.key_assignment,k=h?.key_type?.name,f=m?.stay_till,c=f?new Date(f):null,a=new Date,_=c!==null&&c<a,l=h?.status,y=m?.phone_number?.trim();console.log("Data:",{keyTypeName:k,status:l,phoneNumber:y,stayTillRaw:f,isExpired:_});let d=C,o=!1;return k==="key_finder"&&(l==="inactive"||!y?(d=T,o=!0,console.log("1")):c&&c>a?(d=C,console.log("3")):l==="active"&&y&&_&&(d=S,console.log("4"))),n.useEffect(()=>{o&&w(!0)},[o]),e.jsxs(e.Fragment,{children:[e.jsxs(I,{children:[e.jsx("title",{children:s?.heading??"Hotel"}),e.jsx("link",{rel:"icon",type:"image/png",href:s?.logo_image_url??"/images/building-placeholder.webp"}),e.jsx("meta",{property:"og:title",content:s?.heading??"Hotel"}),e.jsx("meta",{property:"og:description",content:s?.meta_description??s?.description??"Book your perfect stay with us!"}),e.jsx("meta",{property:"og:image",content:s?.logo_image_url??"/images/building-placeholder.webp"}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:typeof window<"u"?window.location.href:""}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:s?.heading??"Hotel"}),e.jsx("meta",{name:"twitter:description",content:s?.meta_description??s?.description??"Book your perfect stay with us!"}),e.jsx("meta",{name:"twitter:image",content:s?.logo_image_url??"/images/building-placeholder.webp"})]}),e.jsx(M,{realPhone:!0,defaultView:x,showNextBox:d===S,children:e.jsx(d,{})}),t&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50",children:e.jsx("div",{className:"loader border-t-transparent border-4 border-[#b6ffb5] rounded-full w-10 h-10 animate-spin"})})]})}z.layout=i=>e.jsx(e.Fragment,{children:e.jsx(V,{children:i})});export{z as default};
