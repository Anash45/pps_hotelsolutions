import{r as n,b as C,j as e,c as v,I as u,T as p,a as r,D as P,S as T,e as F,P as D,h as B,i as L,k as A,H as I}from"./app-BPoMNK8q.js";import{G as M}from"./GuestBox-Cy8GhKHf.js";import{H as k}from"./HotelKeyFinder-BtXEVqTF.js";import{H as S}from"./HotelLanding-Dy70IsYf.js";import{F as G}from"./FlashMessage-Biab_UtL.js";import{G as K}from"./GuestKeyLayout-CZ2yvkXZ.js";import{m as V}from"./mapHotelToBrandingFormData-4vqDWvsW.js";function R(){const[i,h]=n.useState(!1),{t:s}=C("Components.userSelfEdit");if(i)return e.jsx(E,{});const{codeDetails:g}=v().props,[t,x]=n.useState({}),[j,_]=n.useState(""),[m,w]=n.useState(!0),[f,c]=n.useState(!1),[a,b]=n.useState({salutation:"",title:"",first_name:"",last_name:"",room_number:"",phone_number:"",email:"",stay_from:"",stay_till:"",gdpr_consent:m,code_id:g?.code??null}),l=d=>{const{name:o,value:N}=d.target;b(H=>({...H,[o]:N}))},y=async d=>{d.preventDefault(),x({}),_(""),c(!0);try{const o=await B.post(route("keyassignment.userStore"),a);o.data.success?(c(!1),_(o.data.message),setTimeout(()=>window.location.reload(),2e3)):(c(!1),x({general:[o.data.message]}))}catch(o){if(c(!1),o.response?.status===422){const N=o.response.data;x(N.errors||{general:[N.message]})}else x({general:[s("genericError")]})}};return e.jsxs("form",{onSubmit:y,className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-lg text-[#201A20] font-semibold",children:s("title")}),e.jsx("p",{className:"text-xs font-medium text-[#475569]",children:s("subtitle")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"stay_from",value:s("stayFrom"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"stay_from",name:"stay_from",value:a.stay_from,onChange:l,type:"date",className:"date-inp block w-full",placeholder:"dd.mm.yyyy"}),e.jsx(r,{message:t.stay_from})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"stay_till",value:s("stayTill"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"stay_till",name:"stay_till",value:a.stay_till,onChange:l,type:"date",className:"date-inp block w-full",placeholder:"dd.mm.yyyy"}),e.jsx(r,{message:t.stay_till})]})]}),e.jsx(P,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"salutation",value:s("salutation"),className:"text-[#475569] text-xs font-medium"}),e.jsx(T,{id:"salutation",name:"salutation",value:a.salutation,onChange:l,className:"w-full block",options:[{value:"Mr",label:s("mr")},{value:"Mrs",label:s("mrs")},{value:"Ms",label:s("ms")}]}),e.jsx(r,{message:t.salutation})]}),m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"title",value:s("titleLabel"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"title",name:"title",value:a.title,onChange:l,type:"text",className:"block w-full",placeholder:s("titlePlaceholder")}),e.jsx(r,{message:t.title})]}),m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"first_name",value:s("firstName"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"first_name",name:"first_name",value:a.first_name,onChange:l,type:"text",className:"block w-full",placeholder:s("firstNamePlaceholder")}),e.jsx(r,{message:t.first_name})]}),m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"last_name",value:s("lastName"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"last_name",name:"last_name",value:a.last_name,onChange:l,type:"text",className:"block w-full",placeholder:s("lastNamePlaceholder")}),e.jsx(r,{message:t.last_name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"room_number",value:s("roomNumber"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"room_number",name:"room_number",value:a.room_number,onChange:l,type:"text",className:"block w-full",placeholder:s("roomNumberPlaceholder")}),e.jsx(r,{message:t.room_number})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"phone_number",value:s("phoneNumber"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"phone_number",name:"phone_number",value:a.phone_number,onChange:l,type:"tel",className:"block w-full",placeholder:s("phoneNumberPlaceholder")}),e.jsx(r,{message:t.phone_number})]}),m&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"email",value:s("email"),className:"text-[#475569] text-xs font-medium"}),e.jsx(p,{id:"email",name:"email",value:a.email,onChange:l,type:"email",className:"block w-full",placeholder:s("emailPlaceholder")}),e.jsx(r,{message:t.email})]})]})]}),e.jsx(G,{message:j}),e.jsxs("div",{className:"flex items-center gap-2 justify-end flex-wrap",children:[f&&e.jsx("p",{className:"text-sm",children:s("loading")}),Object.keys(t).length>0&&e.jsx(r,{message:t?.general??s("formError")}),e.jsx(F,{onClick:()=>h(!0),children:s("cancel")}),e.jsx(D,{disabled:f,type:"submit",children:s("save")})]})]})}function E(){const{codeDetails:i,flash:h}=v().props,[s,g]=n.useState(!1),{t}=C("Components.AskDetails"),x=()=>{L.get(route("key.makeActive",{code:i.code}))},j=()=>{g(!0)};return s?e.jsx(R,{}):e.jsxs("div",{className:"space-y-4 text-center sm:px-7 py-4 text-base",children:[e.jsx("div",{className:"h-[120px] w-[120px] flex items-center justify-center mx-auto rounded-full border-light border",children:e.jsx("img",{src:"/images/key_icon.svg",alt:"Key",className:"h-16 w-16"})}),e.jsx("p",{dangerouslySetInnerHTML:{__html:t("description1")}}),e.jsx("p",{dangerouslySetInnerHTML:{__html:t("description2")}}),e.jsx("p",{children:t("question")}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(D,{onClick:j,children:t("yes")}),e.jsx(F,{onClick:x,children:t("no")})]})]})}function q(){const{selectedHotel:i=null,codeDetails:h}=v().props,{brandingFormData:s,setBrandingFormData:g,loadingButton:t}=n.useContext(A),[x,j]=n.useState(!1),{url:_}=v();n.useEffect(()=>{i&&g(V(i,{user_view:!0}))},[i,_]);const m=h?.key_assignment,w=h?.key_type?.name,f=m?.stay_till,c=f?new Date(f):null,a=new Date,b=c!==null&&c<a,l=h?.status,y=m?.phone_number?.trim();console.log("Data:",{keyTypeName:w,status:l,phoneNumber:y,stayTillRaw:f,isExpired:b});let d=S,o=!1;return w==="key_finder"&&(l==="inactive"||!y?(d=E,o=!0,console.log("1")):c&&c>a?(d=S,console.log("3")):l==="active"&&y&&b&&(d=k,console.log("4"))),n.useEffect(()=>{o&&j(!0)},[o]),e.jsxs(e.Fragment,{children:[e.jsxs(I,{children:[e.jsx("title",{children:s?.heading??"Hotel"}),e.jsx("link",{rel:"icon",type:"image/png",href:s?.logo_image_url??"/images/building-placeholder.webp"}),e.jsx("meta",{property:"og:title",content:s?.heading??"Hotel"}),e.jsx("meta",{property:"og:description",content:s?.meta_description??s?.description??"Book your perfect stay with us!"}),e.jsx("meta",{property:"og:image",content:s?.logo_image_url??"/images/building-placeholder.webp"}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:typeof window<"u"?window.location.href:""}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:s?.heading??"Hotel"}),e.jsx("meta",{name:"twitter:description",content:s?.meta_description??s?.description??"Book your perfect stay with us!"}),e.jsx("meta",{name:"twitter:image",content:s?.logo_image_url??"/images/building-placeholder.webp"})]}),e.jsx(M,{realPhone:!0,defaultView:x,showNextBox:d===k,children:e.jsx(d,{})}),t&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50",children:e.jsx("div",{className:"loader border-t-transparent border-4 border-[#b6ffb5] rounded-full w-10 h-10 animate-spin"})})]})}q.layout=i=>e.jsx(e.Fragment,{children:e.jsx(K,{children:i})});export{q as default};
