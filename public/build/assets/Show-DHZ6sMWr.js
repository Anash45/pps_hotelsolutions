import{r,b as F,j as e,c as N,A as s,I as c,T as h,a as i,D as H,S as A,e as C,P as D,h as B,i as L,k as M,H as P}from"./app-DJvnIb3M.js";import{G}from"./GuestBox-CAKN5Znv.js";import{H as k}from"./HotelKeyFinder-Cmg-uo36.js";import{H as S}from"./HotelLanding-CIslCePZ.js";import{F as I}from"./FlashMessage-DM2Mj93r.js";import{G as K}from"./GuestKeyLayout-CgSspuL8.js";import{m as R}from"./mapHotelToBrandingFormData-4vqDWvsW.js";function V(){const[m,j]=r.useState(!1);if(F("Components.userSelfEdit"),m)return e.jsx(E,{});const{codeDetails:l}=N().props,[t,x]=r.useState({}),[g,_]=r.useState(""),[d,w]=r.useState(!0),[y,u]=r.useState(!1),[a,v]=r.useState({salutation:"",title:"",first_name:"",last_name:"",room_number:"",phone_number:"",email:"",stay_from:"",stay_till:"",gdpr_consent:d,code_id:l?.code??null}),o=f=>{const{name:n,value:p}=f.target;v(T=>({...T,[n]:p}))},b=async f=>{f.preventDefault(),x({}),_(""),u(!0);try{const n=await B.post(route("keyassignment.userStore"),a);n.data.success?(u(!1),_(n.data.message),setTimeout(()=>window.location.reload(),2e3)):(u(!1),x({general:[n.data.message]}))}catch(n){if(u(!1),n.response?.status===422){const p=n.response.data;x(p.errors||{general:[p.message]})}else x({general:[e.jsx(s,{text:"Something went wrong."})]})}};return e.jsxs("form",{onSubmit:b,className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-lg text-[#201A20] font-semibold",children:e.jsx(s,{text:"Register Key Finder"})}),e.jsx("p",{className:"text-xs font-medium text-[#475569]",children:e.jsx(s,{text:"Setup key finder"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{htmlFor:"stay_from",value:e.jsx(s,{text:"Stay from"}),className:"text-[#475569] text-xs font-medium"}),e.jsx(h,{id:"stay_from",name:"stay_from",value:a.stay_from,onChange:o,type:"date",className:"date-inp block w-full",placeholder:"dd.mm.yyyy"}),e.jsx(i,{message:t.stay_from})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{htmlFor:"stay_till",value:e.jsx(s,{text:"Stay till"}),className:"text-[#475569] text-xs font-medium"}),e.jsx(h,{id:"stay_till",name:"stay_till",value:a.stay_till,onChange:o,type:"date",className:"date-inp block w-full",placeholder:"dd.mm.yyyy"}),e.jsx(i,{message:t.stay_till})]})]}),e.jsx(H,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[d&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{htmlFor:"salutation",value:e.jsx(s,{text:"Salutation"}),className:"text-[#475569] text-xs font-medium"}),e.jsx(A,{id:"salutation",name:"salutation",value:a.salutation,onChange:o,className:"w-full block",options:[{value:"Mr",label:e.jsx(s,{text:"Mr."})},{value:"Mrs",label:e.jsx(s,{text:"Mrs."})},{value:"Ms",label:e.jsx(s,{text:"Ms."})}]}),e.jsx(i,{message:t.salutation})]}),d&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{htmlFor:"title",value:e.jsx(s,{text:"Title"}),className:"text-[#475569] text-xs font-medium"}),e.jsx(h,{id:"title",name:"title",value:a.title,onChange:o,type:"text",className:"block w-full",placeholder:"e.g. Dr."}),e.jsx(i,{message:t.title})]}),d&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{htmlFor:"first_name",value:e.jsx(s,{text:"First Name"}),className:"text-[#475569] text-xs font-medium"}),e.jsx(h,{id:"first_name",name:"first_name",value:a.first_name,onChange:o,type:"text",className:"block w-full",placeholder:"e.g. John"}),e.jsx(i,{message:t.first_name})]}),d&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{htmlFor:"last_name",value:e.jsx(s,{text:"Last Name"}),className:"text-[#475569] text-xs font-medium"}),e.jsx(h,{id:"last_name",name:"last_name",value:a.last_name,onChange:o,type:"text",className:"block w-full",placeholder:"e.g. Doe"}),e.jsx(i,{message:t.last_name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{htmlFor:"room_number",value:e.jsx(s,{text:"Room Number"}),className:"text-[#475569] text-xs font-medium"}),e.jsx(h,{id:"room_number",name:"room_number",value:a.room_number,onChange:o,type:"text",className:"block w-full",placeholder:"e.g. 321"}),e.jsx(i,{message:t.room_number})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"phone_number",value:e.jsx(s,{text:"Mobile Phone Number (for Key Finder only)"}),className:"text-[#475569] text-xs font-medium"}),e.jsx(h,{id:"phone_number",name:"phone_number",value:a.phone_number,onChange:o,type:"tel",className:"block w-full",placeholder:"e.g. +49 123 456789"}),e.jsx(i,{message:t.phone_number})]}),d&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{htmlFor:"email",value:e.jsx(s,{text:"Email Address"}),className:"text-[#475569] text-xs font-medium"}),e.jsx(h,{id:"email",name:"email",value:a.email,onChange:o,type:"email",className:"block w-full",placeholder:"e.g. example@xyz.com"}),e.jsx(i,{message:t.email})]})]})]}),e.jsx(I,{message:g}),e.jsxs("div",{className:"flex items-center gap-2 justify-end flex-wrap",children:[e.jsxs("div",{className:"flex gap-2",children:[y&&e.jsx("p",{className:"text-sm",children:e.jsx(s,{text:"Loading..."})}),Object.keys(t).length>0&&e.jsx(i,{message:t?.general??e.jsx(s,{text:"Fix the errors in the form."})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{onClick:()=>j(!0),children:e.jsx(s,{text:"Cancel"})}),e.jsx(D,{disabled:y,type:"submit",children:e.jsx(s,{text:"Save"})})]})]})]})}function E(){const{codeDetails:m,flash:j}=N().props,[l,t]=r.useState(!1);F("Components.AskDetails");const x=()=>{L.get(route("key.makeActive",{code:m.code}))},g=()=>{t(!0)};return l?e.jsx(V,{}):e.jsxs("div",{className:"space-y-4 text-center sm:px-7 py-4 text-base",children:[e.jsx("div",{className:"h-[120px] w-[120px] flex items-center justify-center mx-auto rounded-full border-light border",children:e.jsx("img",{src:"/images/key_icon.svg",alt:"Key",className:"h-16 w-16"})}),e.jsx("p",{children:e.jsx(s,{text:"This key can serve as a key finder after your stay."})}),e.jsx("p",{children:e.jsx(s,{text:'To do so, you must enter your mobile number along with other details in the next dialog so that a finder can <span class="font-bold">contact you</span>.'})}),e.jsx("p",{children:e.jsx(s,{text:"Would you like to use the key finder function?"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(D,{onClick:g,children:e.jsx(s,{text:"Yes"})}),e.jsx(C,{onClick:x,children:e.jsx(s,{text:"No"})})]})]})}function z(){const{selectedHotel:m=null,codeDetails:j}=N().props,{brandingFormData:l,setBrandingFormData:t,loadingButton:x}=r.useContext(M),[g,_]=r.useState(!1),{url:d}=N();r.useEffect(()=>{m&&t(R(m,{user_view:!0}))},[m,d]);const w=j?.key_assignment,y=j?.key_type?.name,u=w?.stay_till,a=u?new Date(u):null,v=new Date,o=a!==null&&a<v,b=j?.status,f=w?.phone_number?.trim();console.log("Data:",{keyTypeName:y,status:b,phoneNumber:f,stayTillRaw:u,isExpired:o});let n=S,p=!1;return y==="key_finder"&&(b==="inactive"?(n=E,p=!0,console.log("1")):a&&a>v||!f?(n=S,console.log("3")):b==="active"&&f&&o&&(n=k,console.log("4"))),r.useEffect(()=>{p&&_(!0)},[p]),e.jsxs(e.Fragment,{children:[e.jsxs(P,{children:[e.jsx("title",{children:l?.heading??"Hotel"}),e.jsx("link",{rel:"icon",type:"image/png",href:l?.logo_image_url??"/images/building-placeholder.webp"}),e.jsx("meta",{property:"og:title",content:l?.heading??"Hotel"}),e.jsx("meta",{property:"og:description",content:l?.meta_description??l?.description??"Book your perfect stay with us!"}),e.jsx("meta",{property:"og:image",content:l?.logo_image_url??"/images/building-placeholder.webp"}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:typeof window<"u"?window.location.href:""}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:l?.heading??"Hotel"}),e.jsx("meta",{name:"twitter:description",content:l?.meta_description??l?.description??"Book your perfect stay with us!"}),e.jsx("meta",{name:"twitter:image",content:l?.logo_image_url??"/images/building-placeholder.webp"})]}),e.jsx(G,{realPhone:!0,defaultView:g,showNextBox:n===k,children:e.jsx(n,{})}),x&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50",children:e.jsx("div",{className:"loader border-t-transparent border-4 border-[#b6ffb5] rounded-full w-10 h-10 animate-spin"})})]})}z.layout=m=>e.jsx(e.Fragment,{children:e.jsx(K,{children:m})});export{z as default};
